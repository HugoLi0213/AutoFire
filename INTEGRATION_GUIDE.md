# AutoHotkey Integration Guide

## Overview

AutoFire now includes **integrated AutoHotkey v2 support** directly in the UI! You can switch between Python and AutoHotkey modes with a single click.

## Why Two Modes?

### Python Mode
- **Pros**: No additional software needed, works immediately
- **Cons**: Requires administrator privileges, may be detected by anti-cheat systems in games
- **Best for**: Testing, non-game applications, when AHK is not installed

### AutoHotkey Mode ⭐ RECOMMENDED FOR GAMES
- **Pros**: Better game compatibility, lower CPU usage, harder to detect
- **Cons**: Requires AutoHotkey v2 installation
- **Best for**: Gaming, bypassing anti-cheat, maximum compatibility

## Setup

### 1. Install AutoHotkey v2

Download and install from: **https://www.autohotkey.com/**

Make sure you install **version 2.0** (not v1.1).

### 2. Use the App

1. Launch `app.py` (or `python autofire_ui.py`)
2. Select your mode:
   - **Python (requires admin)** - Uses Python keyboard hooks
   - **AutoHotkey (better game support)** - Uses AHK script ⭐
3. Configure your keys and interval
4. Click **Start**

The app will automatically:
- Generate `autofire.ahk` with your settings
- Launch the AHK script in the background
- Update the script when you change settings

## How It Works

### Python Mode
When you click Start in Python mode:
1. Registers global keyboard hooks using the `keyboard` library
2. Requires Windows Administrator privileges to suppress keys
3. Uses `keyboard.press_and_release()` or optional scancode SendInput

### AutoHotkey Mode
When you click Start in AutoHotkey mode:
1. Generates `autofire.ahk` with your exact settings
2. Launches the script using `AutoHotkey64.exe`
3. The script runs independently in the background
4. When you click Stop, terminates the AHK process

### Auto-Generated Script
The `autofire.ahk` file is **automatically generated** every time you click Start in AHK mode. Don't edit it manually - your changes will be overwritten!

Example generated script:
```ahk
#Requires AutoHotkey v2.0
; Auto-generated by AutoFire - DO NOT EDIT MANUALLY

TriggerKey := "`"          ; Backtick
OutputKey := "e"           ; Key to spam
IntervalMs := 100          ; Milliseconds between each output
PassThrough := false       ; Block trigger key

; Emergency stop (Ctrl+Alt+Esc)
^!Esc::{
    ExitApp
}

; Hotkey registration
Hotkey "$`" TriggerKey, TriggerPress
Hotkey "$`" TriggerKey " up", TriggerRelease

TriggerPress(*) {
    global IsRunning
    IsRunning := true
    SetTimer AutoFireLoop, IntervalMs
}

TriggerRelease(*) {
    global IsRunning
    IsRunning := false
    SetTimer AutoFireLoop, 0
}

AutoFireLoop() {
    global IsRunning, TriggerKey, OutputKey
    if (!IsRunning || !GetKeyState(TriggerKey, "P")) {
        IsRunning := false
        SetTimer AutoFireLoop, 0
        return
    }
    Send "{" OutputKey "}"
}
```

## Config File

Settings are saved to `autofire.json`:

```json
{
  "intervalMs": 100,
  "outputKey": "e",
  "passThrough": false,
  "triggerKey": "`",
  "useAhk": true
}
```

The new `useAhk` field remembers your mode preference.

## Troubleshooting

### "AutoHotkey v2 not found"
- Install AutoHotkey v2 from https://www.autohotkey.com/
- The app searches these locations:
  - `C:\Program Files\AutoHotkey\v2\AutoHotkey64.exe`
  - `C:\Program Files\AutoHotkey\v2\AutoHotkey32.exe`
  - `C:\Program Files (x86)\AutoHotkey\v2\` (same)

### AHK script not working in game
- Try running the app as Administrator (right-click → Run as administrator)
- Test in Notepad first to verify it works
- Some games block all macro software - try windowed mode or different game

### Python mode says "Could not block trigger key"
- Run the app as Administrator
- Windows requires elevated privileges for keyboard suppression

### Want to manually edit the AHK script?
1. Click Start to generate the initial script
2. Click Stop
3. Edit `autofire.ahk` manually
4. Run it directly (double-click the file)
5. Don't use the app's Start button or your changes will be overwritten

## Key Name Reference

The app automatically converts between Python and AHK key names:

| Python | AutoHotkey |
|--------|-----------|
| `` ` `` | `` ` `` (escaped) |
| `esc` | `Escape` |
| `enter` | `Enter` |
| `space` | `Space` |
| `f1` - `f12` | `F1` - `F12` |
| `a` - `z` | `a` - `z` |
| `0` - `9` | `0` - `9` |

Most single-character keys work the same in both modes.

## Emergency Stop

Both modes support **Ctrl+Alt+Esc** to immediately stop AutoFire and exit.

## Advantages Over Standalone AHK Script

Using the integrated mode instead of the standalone `autofire.ahk`:
- ✅ Easy configuration via GUI (no need to edit script)
- ✅ Settings persist in `autofire.json`
- ✅ Switch between Python and AHK modes instantly
- ✅ Visual status feedback in the UI
- ✅ Automatic script generation with correct key mappings
- ✅ One-click start/stop control

## Testing

Run the test suite to verify Python mode:
```bash
python -m pytest
```

Note: Tests cover Python mode only. AHK mode should be tested manually by launching the app and trying both modes.

## Anti-Cheat Warning

⚠️ **IMPORTANT**: Using ANY macro software (Python or AutoHotkey) in competitive multiplayer games may violate terms of service and result in bans. Use at your own risk!

Games with kernel-mode anti-cheat (Valorant, Fortnite, Apex Legends, etc.) may detect both modes. AutoHotkey mode is generally safer but not undetectable.

For maximum safety, use hardware macro devices (Razer, Logitech, Corsair) with onboard memory.
